// Document generated by internal/documentation/tasks.go from template.adoc.tmpl; DO NOT EDIT.

= ods-start

Starts the pipeline run.

This task will clone a repo from the provided url into the workspace, and
sets the build status of the checked out commit in Bitbucket to "in progress".

If the checked out repositories' `ods.y(a)ml` file defines subrepos, those will
be checked out as well into `.ods/repos`. Subrepos will be checked out at
the branch specified in `ods.y(a)ml` or `master` if no branch is given.
However, if a version (e.g. `1.0.0`) is defined in `ods.y(a)ml`, then
subrepos are checked out at a corresponding release branch (e.g.
`release/1.0.0`) if it exists.

Any artifacts in Nexus for the checked out Git commits are downloaded and
placed into `.ods/artifacts`. When subrepos are configured, a successful
pipeline run must exist for each subrepo for the pipeline to continue. If no
such run artifact exists, the pipeline will stop. Users will need to re-run
the pipeline of the subrepo first before running the pipeline of the
umbrella repo again.

If a target environment has been resolved based on the `branchToEnvironmentMapping`
configuration, its `stage` value determines if Git tags are applied:

* for target environments of stage `dev`, no tags are applied
* for target environments of stage `qa`, a `version` must be set in the `ods.y(a)ml`
  and a `v<VERSION>-rc.<NUMBER>` tag is applied. Numbering starts at 1 and increases
  by one for every subsequent pipeline run.
* for target environments of stage `prod`, a `version` must be set in the `ods.y(a)ml`
  and a `v<VERSION>` tag is applied. A `v<VERSION>-rc.<NUMBER>` tag must alreadu exist
  for the checked out commit, otherwise the pipeline run is aborted.

If a pipeline runs for `qa` or `prod` stages with a version for which a `v<VERSION>`
tag exists already, no further tags are created.

*This task is automatically added to any pipeline run as the first task
by the pipeline manager and cannot be customized by users at this point.*


== Parameters

[cols="1,1,2"]
|===
| Parameter | Default | Description

| url
| 
| Git URL to clone


| git-full-ref
| 
| Git revision to checkout (branch, tag, sha, ref, ...)


| refspec
| 
| (Optional) Git refspec to fetch before checking out revision.


| submodules
| true
| Defines if the resource should initialize and fetch the submodules.


| depth
| 1
| Performs a shallow clone where only the most recent commit(s) will be fetched.


| ssl-verify
| true
| Defines if http.sslVerify should be set to `true` or `false` in the global Git config.


| http-proxy
| 
| Git HTTP proxy server for non-SSL requests.


| https-proxy
| 
| Git HTTPS proxy server for SSL requests.


| no-proxy
| 
| Git no proxy - opt out of proxying HTTP/HTTPS requests.


| project
| 
| Name of the project to build. The project is equal to the Bitbucket project of the repository to clone.


| environment
| 
| Name of the environment to deploy to.


| version
| 
| Version of the application. If not set, version will default to `WIP`.


| pr-key
| 
| Bitbucket pull request key. Empty if there is no open PR for the specified Git branch.


| pr-base
| 
| Bitbucket pull request base branch. Empty if there is no open PR for the specified Git branch.


| pipeline-run-name
| 
| Name of pipeline run.


| cache-build-tasks-for-days
| 7
| Number of days build tasks are cached to enable build skipping. A subsequent build reusing the cache resets the time for that cache location.

|===

== Results

[cols="1,3"]
|===
| Name | Description

| commit
| The commit SHA that was fetched by this task.


| url
| The URL that was fetched by this task.

|===
